# Development Dockerfile with hot-reload support
FROM rust:1.82

# Install dependencies
RUN apt-get update && apt-get install -y \
    postgresql-client \
    netcat-traditional \
    && rm -rf /var/lib/apt/lists/*

# Install development tools
RUN cargo install cargo-watch
RUN cargo install sqlx-cli --no-default-features --features postgres

WORKDIR /workspace

# The source code will be mounted as a volume
# This avoids rebuilding the image when code changes
CMD ["cargo", "watch", "-x", "run --bin replicant-server"]